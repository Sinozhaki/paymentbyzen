<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Rent by Zen 8800</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Palette */
            --bg-color: #f3f4f6; --text-color: #475569; --heading-color: #1e293b;
            --accent: #0a66c2; --accent-hover: #004182;
            --success: #10b981; --success-hover: #059669;
            --danger: #ef4444; --warning: #f59e0b; --purple: #7c3aed;
            --border-color: #cbd5e1; --card-bg: #ffffff;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            color: var(--text-color);
            margin: 0; padding: 0;
            min-height: 100vh;
            display: flex; justify-content: center; align-items: center;
            overflow-x: hidden; position: relative;
            padding-top: 40px; /* Space for Running Text */
        }

        /* --- RUNNING TEXT --- */
        .running-text-bar {
            position: fixed; top: 0; left: 0; width: 100%;
            background: var(--danger); color: white;
            padding: 12px 0; z-index: 3000; overflow: hidden;
            box-shadow: 0 4px 10px rgba(239, 68, 68, 0.3);
            font-weight: 800; font-size: 0.85rem; letter-spacing: 0.5px; text-transform: uppercase;
        }
        .marquee-content {
            display: inline-block; white-space: nowrap;
            padding-left: 100%; animation: scroll-left 25s linear infinite;
        }
        @keyframes scroll-left { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }

        /* --- WAVES ANIMATION --- */
        .waves-container {
            position: fixed; bottom: 0; left: 0; width: 100%; height: 20vh;
            min-height: 100px; max-height: 250px; z-index: -1; pointer-events: none;
        }
        .waves { position: relative; width: 100%; height: 100%; margin-bottom: -7px; }
        .parallax > use { animation: move-forever 25s cubic-bezier(.55,.5,.45,.5) infinite; }
        .parallax > use:nth-child(1) { animation-delay: -2s; animation-duration: 7s; fill: rgba(10, 102, 194, 0.7); }
        .parallax > use:nth-child(2) { animation-delay: -3s; animation-duration: 10s; fill: rgba(10, 102, 194, 0.5); }
        .parallax > use:nth-child(3) { animation-delay: -4s; animation-duration: 13s; fill: rgba(10, 102, 194, 0.3); }
        .parallax > use:nth-child(4) { animation-delay: -5s; animation-duration: 20s; fill: rgba(10, 102, 194, 0.1); }
        @keyframes move-forever { 0% { transform: translate3d(-90px,0,0); } 100% { transform: translate3d(85px,0,0); } }

        /* --- CONTAINER --- */
        .container {
            width: 90%; max-width: 450px; background: transparent;
            box-shadow: none; border: none; padding: 2rem 1rem;
            text-align: center; position: relative; z-index: 1;
        }
        h1 { margin: 0 0 10px; color: var(--accent); font-size: 2.2rem; font-weight: 800; letter-spacing: -0.03em; animation: breathe 3s infinite ease-in-out; }
        @keyframes breathe { 0%, 100% { text-shadow: 0 0 10px rgba(10, 102, 194, 0.1); transform: scale(1); } 50% { text-shadow: 0 0 25px rgba(10, 102, 194, 0.6), 0 0 10px rgba(10, 102, 194, 0.4); transform: scale(1.02); } }
        .small-note { font-size: 0.9rem; color: #64748b; margin-bottom: 2rem; font-weight: 500; }
        .separator { border: 0; height: 2px; background-image: linear-gradient(to right, rgba(10, 102, 194, 0), var(--accent), rgba(10, 102, 194, 0)); margin-bottom: 2rem; opacity: 0.5; }

        /* --- BANNER --- */
        .promo-banner {
            width: 100%; height: auto; border-radius: 20px;
            margin-bottom: 25px;
            box-shadow: 0 10px 20px rgba(10, 102, 194, 0.15);
            display: block; transition: transform 0.3s;
        }
        .promo-banner:hover { transform: scale(1.02); }

        /* --- FORM ELEMENTS --- */
        .input-group { position: relative; margin-bottom: 1.5rem; text-align: left; }
        label { display: block; margin-bottom: 0.8rem; font-size: 0.9rem; font-weight: 700; color: var(--heading-color); margin-left: 10px; }
        
        input, select {
            width: 100%; padding: 16px 25px; border-radius: 50px;
            border: 2px solid #cbd5e1; background: white;
            color: var(--heading-color); box-sizing: border-box;
            font-size: 1rem; outline: none; transition: 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.02); font-family: 'Plus Jakarta Sans', sans-serif;
        }
        select {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%230a66c2%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
            background-repeat: no-repeat; background-position: right 20px center; background-size: 12px;
        }
        input:focus, select:focus { border-color: var(--accent); box-shadow: 0 0 0 4px rgba(10, 102, 194, 0.1); }
        input.error { border-color: var(--danger); animation: shake 0.3s; }
        .error-msg { color: var(--danger); font-size: 0.85rem; margin-top: 8px; display: none; font-weight: bold; text-align: center; }

        .btn {
            width: 100%; padding: 16px; border: none; border-radius: 50px;
            font-weight: 800; font-size: 1rem; cursor: pointer; transition: 0.3s;
            text-transform: uppercase; letter-spacing: 0.5px;
            box-shadow: 0 10px 15px -3px rgba(10, 102, 194, 0.3); font-family: 'Plus Jakarta Sans', sans-serif;
        }
        .btn-primary { background: var(--accent); color: white; }
        .btn-primary:hover { background: var(--accent-hover); transform: translateY(-2px); box-shadow: 0 15px 20px -3px rgba(10, 102, 194, 0.4); }

        /* --- SPINNER --- */
        #loading-view { display: none; margin-top: 2rem; }
        .spinner { width: 40px; height: 40px; border: 4px solid rgba(10, 102, 194, 0.1); border-left-color: var(--accent); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 10px; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        .loading-text { font-size: 0.9rem; color: var(--accent); font-weight: 600; animate: pulse 1s infinite; }

        /* --- RESULT CARD --- */
        #result-card { margin-top: 2.5rem; padding: 1.5rem; background: white; border: 1px solid var(--border-color); border-radius: 20px; display: none; text-align: left; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        .result-row { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f1f5f9; }
        .result-row:last-child { border-bottom: none; }
        .res-label { color: #64748b; font-size: 0.9rem; font-weight: 600; }
        .res-val { font-weight: 700; color: var(--heading-color); }
        .btn-withdraw { background: var(--success); color: white; margin-top: 20px; box-shadow: 0 10px 15px -3px rgba(16, 185, 129, 0.3); }
        .btn-withdraw:hover { background: var(--success-hover); transform: translateY(-2px); box-shadow: 0 15px 20px -3px rgba(16, 185, 129, 0.4); }

        /* --- WITHDRAW MODAL STYLES --- */
        .wd-label { text-align: left; display: block; font-weight: 700; margin-bottom: 8px; color: var(--heading-color); font-size: 0.9rem; margin-top: 15px;}
        .wd-input { width: 100%; padding: 14px; border-radius: 12px; border: 2px solid #cbd5e1; font-family: 'Plus Jakarta Sans', sans-serif; font-size: 1rem; box-sizing: border-box; }
        .wd-input:focus { border-color: var(--success); outline: none; }
        
        /* Grid Selection */
        .bank-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 10px; }
        .bank-item { border: 2px solid #e2e8f0; border-radius: 12px; padding: 10px 5px; cursor: pointer; transition: 0.2s; font-weight: 700; font-size: 0.8rem; color: #64748b; display: flex; align-items: center; justify-content: center; text-align: center; height: 40px; }
        .bank-item:hover { border-color: #94a3b8; }
        .bank-item.active { border-color: var(--accent); background: rgba(10, 102, 194, 0.05); color: var(--accent); }
        
        .remember-me { display: flex; align-items: center; margin-top: 15px; gap: 10px; font-size: 0.9rem; color: var(--text-color); font-weight: 600; cursor: pointer; }
        .remember-me input { width: 20px; height: 20px; border-radius: 6px; accent-color: var(--success); cursor: pointer; box-shadow: none; }
        
        .withdraw-info { background: #f1f5f9; padding: 15px; border-radius: 12px; margin: 20px 0; text-align: left; border: 1px solid #cbd5e1; }
        .withdraw-info small { display: block; color: #64748b; font-weight: 600; margin-bottom: 5px; }
        .withdraw-info span { color: var(--heading-color); font-weight: 800; font-size: 1.1rem; }

        /* --- ADMIN PANEL (Z-Index Updated to 9999) --- */
        #admin-panel { 
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: #f8fafc; z-index: 9999; padding: 0; overflow-y: scroll; 
        }
        .admin-sticky-header { position: sticky; top: 0; background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(12px); z-index: 10; padding: 1rem 2rem; border-bottom: 1px solid var(--border-color); box-shadow: 0 4px 20px rgba(0,0,0,0.03); }
        .admin-top-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .admin-title { margin: 0; color: var(--accent); font-size: 1.5rem; font-weight: 800; }
        .admin-tools { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 10px; }
        .admin-tools input, .admin-tools select { border-radius: 8px; padding: 10px; font-size: 0.9rem; }
        .card-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; padding: 2rem; }
        .user-card { background: white; border: 1px solid var(--border-color); border-radius: 12px; padding: 20px; transition: 0.3s; display: flex; flex-direction: column; gap: 12px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); }
        .user-card:hover { border-color: var(--accent); transform: translateY(-4px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }
        .uc-header { font-weight: 700; font-size: 1rem; color: var(--heading-color); word-break: break-all; border-bottom: 1px solid #f1f5f9; padding-bottom: 10px; }
        .uc-badges { display: flex; gap: 8px; font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.5px; }
        .badge { padding: 5px 10px; border-radius: 6px; font-weight: 800; color: white;}
        .bg-green { background: var(--success); } .bg-red { background: var(--danger); } .bg-gray { background: #94a3b8; }
        .uc-action-area { margin-top: auto; background: #f8fafc; padding: 12px; border-radius: 8px; border: 1px solid #e2e8f0; }
        .input-row { display: flex; align-items: center; gap: 8px; margin-bottom: 10px; }
        .input-row label { margin: 0; font-size: 0.8rem; min-width: 50px; font-weight: bold;} .input-row input { padding: 8px; border-radius: 6px; }
        .btn-icon { padding: 10px; border-radius: 8px; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 6px; font-weight: 700; font-size: 0.85rem; transition: 0.2s; color: white; font-family: 'Plus Jakarta Sans', sans-serif; }
        .btn-icon svg { width: 18px; height: 18px; stroke-width: 2.5; fill: none; stroke: currentColor; }
        .btn-icon:hover { opacity: 0.9; transform: scale(1.02); }
        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        
        .admin-trigger { position: fixed; bottom: 20px; left: 20px; width: 50px; height: 50px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; border: 2px solid var(--border-color); z-index: 99; transition:0.3s; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .admin-trigger:hover { border-color: var(--accent); transform: scale(1.1) rotate(90deg); }
        .admin-trigger svg { width: 22px; height: 22px; fill: #64748b; transition: 0.3s; }
        .admin-trigger:hover svg { fill: var(--accent); }

        /* --- MODALS (Z-Index Updated to 10000) --- */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(15, 23, 42, 0.5); z-index: 10000; backdrop-filter: blur(8px); justify-content: center; align-items: center; }
        .modal-box { background: white; padding: 2.5rem; border-radius: 24px; width: 90%; max-width: 400px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); text-align: center; max-height: 90vh; overflow-y: auto;}
        .modal-box h3 { margin-top: 0; color: var(--accent); font-weight: 800; margin-bottom: 20px; }
        .modal-buttons { display: flex; gap: 10px; margin-top: 25px; justify-content: center; }
        .btn-reset-opt { width: 100%; padding: 15px; margin-bottom: 12px; border-radius: 12px; border:none; cursor: pointer; font-weight: 700; color: white; transition: 0.2s; font-family: 'Plus Jakarta Sans', sans-serif;}
        .btn-reset-opt:hover { opacity: 0.95; transform: translateY(-2px); }

        @keyframes shake { 0% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } 100% { transform: translateX(0); } }
    </style>
</head>
<body>

    <div class="running-text-bar"><div class="marquee-content">‚ö†Ô∏è PERINGATAN KERAS: KETAHUAN CLAIM AKUN ORANG LAIN = REKENING AKAN DI-FREEZE & DILAPORKAN KE PIHAK BERWAJIB! ‚ö†Ô∏è &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ‚ö†Ô∏è PERINGATAN KERAS: KETAHUAN CLAIM AKUN ORANG LAIN = REKENING AKAN DI-FREEZE & DILAPORKAN KE PIHAK BERWAJIB! ‚ö†Ô∏è</div></div>

    <div class="waves-container">
        <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs> <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" /> </defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0" fill="rgba(10, 102, 194, 0.7)" /><use xlink:href="#gentle-wave" x="48" y="3" fill="rgba(10, 102, 194, 0.5)" /><use xlink:href="#gentle-wave" x="48" y="5" fill="rgba(10, 102, 194, 0.3)" /><use xlink:href="#gentle-wave" x="48" y="7" fill="rgba(10, 102, 194, 0.1)" /></g></svg>
    </div>

    <div class="container">
        <h1>Payment Rent by Zen 8800</h1>
        <p class="small-note">Masukan data bank dengan benar agar tidak hangus</p>
        <hr class="separator">

        <img src="baner.gif" class="promo-banner" alt="Promo Banner">

        <div class="input-group">
            <label for="userEmail">Email LinkedIn</label>
            <input type="email" id="userEmail" placeholder="Masukan email terdaftar...">
            <div id="errorMsg" class="error-msg">‚ö† Email Tidak Ditemukan</div>
        </div>

        <button id="btnCheck" class="btn btn-primary" onclick="validateAndCheck()">CLAIM PAY</button>

        <div id="loading-view"><div class="spinner"></div><div class="loading-text">Sedang Memeriksa Data...</div></div>

        <div id="result-card">
            <h3 style="text-align:center; color:var(--success); margin:0 0 15px 0;">Data Terverifikasi</h3>
            <div class="result-row"><span class="res-label">Email</span><span class="res-val" id="disp-email">...</span></div>
            <div class="result-row"><span class="res-label">Status</span><span class="res-val" id="disp-status">...</span></div>
            <div class="result-row"><span class="res-label">Reward</span><span class="res-val" id="disp-reward" style="color:var(--warning);">...</span></div>
            <div class="result-row"><span class="res-label">Status Klaim</span><span class="res-val" id="disp-claim">...</span></div>
            <button class="btn btn-withdraw" onclick="openWithdrawForm()">CAIRKAN SEKARANG</button>
        </div>
    </div>

    <div class="admin-trigger" onclick="openAdmin()" title="Masuk Admin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M336 352c97.2 0 176-78.8 176-176S433.2 0 336 0S160 78.8 160 176c0 18.7 2.9 36.6 8.3 53.4L7 403.3c-9.4 9.4-9.4 24.6 0 33.9l33.9 33.9c9.4 9.4 24.6 9.4 33.9 0l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l34 34C174.6 492 189.9 492 199.3 482.5l56.5-56.5c2.7-2.7 4.9-5.7 6.6-8.9c25.4 7.6 52.3 11.9 80.3 11.9zM336 96c26.5 0 48 21.5 48 48s-21.5 48-48 48s-48-21.5-48-48s21.5-48 48-48z"/></svg></div>
    
    <div id="admin-panel">
        <div class="admin-sticky-header">
            <div class="admin-top-row"><h2 class="admin-title">Admin Panel</h2><button class="btn-icon" style="background:var(--danger); width:auto; padding:8px 12px;" onclick="closeAdmin()"><svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg> Tutup</button></div>
            <div class="admin-tools">
                <input type="text" id="admSearch" placeholder="üîç Cari Email..." onkeyup="renderCards()">
                <select id="admFilter" onchange="renderCards()"><option value="all">Semua Status</option><option value="new acc">New Acc</option><option value="restric">Restric</option><option value="old acc">Old Acc</option><option value="unrestric">Unrestric</option></select>
                <button class="btn-icon" style="background:var(--purple);" onclick="openMassModal()" title="Set Reward Massal"><svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg> Set Reward</button>
                <button class="btn-icon" style="background:var(--accent);" onclick="forceRefresh()" title="Muat Ulang"><svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg> Refresh</button>
                <button class="btn-icon" style="background:var(--warning); color:black;" onclick="openResetChoiceModal()" title="Pilihan Reset"><svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path></svg> Reset All</button>
            </div>
        </div>
        <div id="admin-grid" class="card-grid"></div>
    </div>

    <div id="withdrawModal" class="modal-overlay">
        <div class="modal-box">
            <h3>Form Pencairan Dana</h3>
            <label class="wd-label">Pilih Bank / E-Wallet:</label>
            <div class="bank-grid">
                <div class="bank-item active" onclick="selectBank(this, 'DANA')">DANA</div>
                <div class="bank-item" onclick="selectBank(this, 'OVO')">OVO</div>
                <div class="bank-item" onclick="selectBank(this, 'GOPAY')">GOPAY</div>
                <div class="bank-item" onclick="selectBank(this, 'SHOPEE')">SHOPEE</div>
                <div class="bank-item" onclick="selectBank(this, 'SEABANK')">SEABANK</div>
                <div class="bank-item" onclick="selectBank(this, 'BCA')">BCA</div>
                <div class="bank-item" onclick="selectBank(this, 'BNI')">BNI</div>
                <div class="bank-item" onclick="selectBank(this, 'JAGO')">JAGO</div>
                <div class="bank-item" onclick="selectBank(this, 'LAINNYA')">LAINNYA</div>
            </div>
            <input type="hidden" id="selectedBank" value="DANA">
            <input type="text" id="wdCustomBank" class="wd-input" placeholder="Tulis Nama Bank/E-Wallet..." style="display:none; margin-top:5px;">
            <label class="wd-label">Nomor Rekening / E-Wallet:</label>
            <input type="number" id="wdRek" class="wd-input" placeholder="Contoh: 08xx / 123xxx">
            <label class="wd-label">Atas Nama:</label>
            <input type="text" id="wdName" class="wd-input" placeholder="Nama Pemilik Akun">
            <label class="remember-me"><input type="checkbox" id="wdRemember"> Simpan data untuk pencairan berikutnya</label>
            <div class="withdraw-info"><small>Email Terverifikasi:</small><span id="wdEmailDisp" style="font-size:0.95rem; display:block; margin-bottom:10px;">-</span><small>Total Pencairan:</small><span id="wdRewardDisp" style="color:var(--success);">-</span></div>
            <div class="modal-buttons"><button class="btn" style="background:#94a3b8; color:white; width:auto;" onclick="closeWithdrawModal()">Batal</button><button class="btn btn-primary" style="background:var(--success); width:auto;" onclick="processWithdraw()">Kirim ke WhatsApp</button></div>
        </div>
    </div>

    <div id="restrictModal" class="modal-overlay">
        <div class="modal-box">
            <h3 style="color:var(--danger);">‚ö†Ô∏è Peringatan</h3>
            <p style="color:#64748b; margin-bottom:15px;">Ga masuk list payment atau akun ke restric.</p>
            <p style="color:#64748b; font-size:0.9rem; margin-bottom:25px;">Jika anda merasa berhak di payment silahkan hubungi admin untuk konfirmasi.</p>
            <div class="modal-buttons"><button class="btn" style="background:#94a3b8; color:white; width:auto;" onclick="closeRestrictModal()">Tutup</button><button class="btn btn-primary" style="background:var(--success); width:auto;" onclick="contactAdminHelp()">Hubungi Admin</button></div>
        </div>
    </div>

    <div id="claimedModal" class="modal-overlay">
        <div class="modal-box">
            <h3 style="color:var(--warning);">‚ö†Ô∏è Sudah Diambil</h3>
            <p style="color:#64748b; margin-bottom:25px;">Maaf, akun ini sudah melakukan claim sebelumnya.</p>
            <button class="btn btn-primary" onclick="closeClaimedModal()">Tutup</button>
        </div>
    </div>

    <div id="massModal" class="modal-overlay"><div class="modal-box"><h3>Atur Reward Massal</h3><label style="display:block; text-align:left; margin-bottom:5px;">Pilih Status Target:</label><select id="massStatusSelect" style="margin-bottom:15px;"><option value="New Acc">New Acc</option><option value="Restric">Restric</option><option value="Old Acc">Old Acc</option><option value="Unrestric">Unrestric</option></select><label style="display:block; text-align:left; margin-bottom:5px;">Nominal Reward Baru:</label><input type="number" id="massAmount" placeholder="Contoh: 50000" style="margin-bottom:20px;"><div class="modal-buttons"><button class="btn" style="background:#94a3b8; color:white; width:auto;" onclick="closeMassModal()">Batal</button><button class="btn btn-primary" style="width:auto;" onclick="confirmMassUpdate()">Simpan</button></div></div></div>
    <div id="resetChoiceModal" class="modal-overlay"><div class="modal-box"><h3 style="color:var(--warning);">‚ö† Pilihan Reset</h3><p style="color:#64748b; font-size:0.9rem; margin-bottom:20px;">Tindakan ini akan mempengaruhi <b>SEMUA DATA</b> di database.</p><button class="btn-reset-opt" style="background:var(--success);" onclick="executeReset('claim')">Reset Status Claim</button><button class="btn-reset-opt" style="background:var(--warning); color:black;" onclick="executeReset('reward')">Reset Nominal Reward</button><button class="btn-reset-opt" style="background:#94a3b8; margin-top:10px;" onclick="closeResetChoiceModal()">Batal</button></div></div>

    <script>
        const ICONS = { save: `<svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></svg>`, check: `<svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>`, x: `<svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>`, rotate: `<svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"></polyline><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path></svg>` };
        const BIN_ID = '6905803fae596e708f3baa25'; const API_KEY = '$2a$10$4v5UzmjJBEf7T6RUlR7CfeJERCrf/waXNcO7pxUk3OYGOzBNLJ7Fy'; const BASE_URL = `https://api.jsonbin.io/v3/b/${BIN_ID}`;
        let globalData = { users: [] }; let isDataLoaded = false; let currentUser = null;

        document.addEventListener('DOMContentLoaded', fetchData);
        async function fetchData() { try { const res = await fetch(BASE_URL, { headers: { 'X-Master-Key': API_KEY } }); const json = await res.json(); globalData = json.record; isDataLoaded = true; console.log("DB Ready"); } catch (e) { console.error(e); } }
        async function saveData(newData) { try { await fetch(BASE_URL, { method: 'PUT', headers: { 'Content-Type': 'application/json', 'X-Master-Key': API_KEY }, body: JSON.stringify(newData) }); alert("Berhasil Disimpan!"); renderCards(); } catch (e) { alert("Gagal Simpan: " + e.message); } }

        function validateAndCheck() {
            if(!isDataLoaded) { alert("Tunggu sebentar, database sedang dimuat..."); return; }
            const input = document.getElementById('userEmail'); const errorMsg = document.getElementById('errorMsg'); const resultCard = document.getElementById('result-card'); const loadingView = document.getElementById('loading-view'); const btnCheck = document.getElementById('btnCheck');
            errorMsg.style.display = 'none'; resultCard.style.display = 'none'; loadingView.style.display = 'block'; btnCheck.style.display = 'none';
            setTimeout(() => {
                const emailVal = input.value.trim().toLowerCase();
                const user = globalData.users.find(u => (u.email||"").trim().toLowerCase() === emailVal);
                loadingView.style.display = 'none'; btnCheck.style.display = 'block';
                if (!user) { input.classList.add('error'); errorMsg.style.display = 'block'; setTimeout(() => input.classList.remove('error'), 500); currentUser = null; }
                else { currentUser = user; resultCard.style.display = 'block'; document.getElementById('disp-email').innerText = user.email; document.getElementById('disp-status').innerText = user.status; document.getElementById('disp-reward').innerText = "Rp " + parseInt(user.reward||0).toLocaleString(); const claimEl = document.getElementById('disp-claim'); claimEl.innerText = user.claim_status === "Claimed" ? "SUDAH DIAMBIL ‚ùå" : "BELUM DIAMBIL ‚úÖ"; claimEl.style.color = user.claim_status === "Claimed" ? "#ef4444" : "#10b981"; }
            }, 1500);
        }

        // --- WITHDRAW LOGIC ---
        function selectBank(element, bankName) {
            document.querySelectorAll('.bank-item').forEach(i => i.classList.remove('active')); element.classList.add('active');
            document.getElementById('selectedBank').value = bankName;
            document.getElementById('wdCustomBank').style.display = (bankName === 'LAINNYA') ? 'block' : 'none';
        }

        function openWithdrawForm() {
            if(!currentUser) return;
            if(currentUser.claim_status === "Claimed") { openClaimedModal(); return; }
            const amount = parseInt(currentUser.reward || 0);
            if (amount <= 0) { openRestrictModal(); return; }

            document.getElementById('wdEmailDisp').innerText = currentUser.email;
            document.getElementById('wdRewardDisp').innerText = "Rp " + parseInt(currentUser.reward||0).toLocaleString();
            try { const savedRek = localStorage.getItem('zen8800_rek'); const savedName = localStorage.getItem('zen8800_name'); if(savedRek) document.getElementById('wdRek').value = savedRek; if(savedName) document.getElementById('wdName').value = savedName; } catch (e) {}
            document.getElementById('withdrawModal').style.display = 'flex';
        }

        function closeWithdrawModal() { document.getElementById('withdrawModal').style.display = 'none'; }

        function processWithdraw() {
            let bank = document.getElementById('selectedBank').value;
            if(bank === 'LAINNYA') { const customVal = document.getElementById('wdCustomBank').value.trim(); if(!customVal) { alert("Silakan tulis nama Bank/E-Wallet."); return; } bank = customVal; }
            const rek = document.getElementById('wdRek').value; const name = document.getElementById('wdName').value; const remember = document.getElementById('wdRemember').checked;
            if(!rek || !name) { alert("Harap lengkapi Nomor Rekening dan Atas Nama."); return; }
            try { if(remember) { localStorage.setItem('zen8800_rek', rek); localStorage.setItem('zen8800_name', name); } } catch(e){}

            // KIRIM WA
            const text = `*FORM PENCAIRAN DANA*%0A---------------------------%0A%0A*Data Akun:*%0Aüìß Email: ${currentUser.email}%0Aüí∞ Reward: Rp ${parseInt(currentUser.reward || 0).toLocaleString()}%0A%0A*Tujuan Pencairan:*%0Aüè¶ Bank/E-Wallet: ${bank}%0Aüí≥ Nomor: ${rek}%0Aüë§ Atas Nama: ${name}%0A%0AMohon segera diproses. Terima kasih.`;
            window.open(`https://wa.me/6289513304878?text=${text}`, '_blank');
            
            // AUTO UPDATE STATUS TO CLAIMED
            const idx = globalData.users.findIndex(u => u.email === currentUser.email);
            if(idx !== -1) {
                globalData.users[idx].claim_status = "Claimed";
                fetch(BASE_URL, { method: 'PUT', headers: { 'Content-Type': 'application/json', 'X-Master-Key': API_KEY }, body: JSON.stringify(globalData) })
                .then(() => {
                    closeWithdrawModal();
                    validateAndCheck(); // Refresh tampilan jadi merah
                });
            }
        }

        // --- MODALS ---
        function openRestrictModal() { document.getElementById('restrictModal').style.display = 'flex'; }
        function closeRestrictModal() { document.getElementById('restrictModal').style.display = 'none'; }
        function openClaimedModal() { document.getElementById('claimedModal').style.display = 'flex'; }
        function closeClaimedModal() { document.getElementById('claimedModal').style.display = 'none'; }
        function contactAdminHelp() {
            const email = currentUser ? currentUser.email : "Tidak diketahui";
            const text = `Halo Admin Zen, saya ingin konfirmasi payment.%0A%0AEmail saya: ${email}%0AKeterangan di web: Tidak masuk list payment/Restricted.%0A%0AMohon bantuannya. Terima kasih.`;
            window.open(`https://wa.me/6289513304878?text=${text}`, '_blank');
            closeRestrictModal();
        }

        // --- ADMIN & TOOLS ---
        function openAdmin() { if(prompt("Sandi Admin:") === "2003") { document.getElementById('admin-panel').style.display = 'block'; renderCards(); } else { alert("Sandi Salah"); } }
        function closeAdmin() { document.getElementById('admin-panel').style.display = 'none'; }
        async function forceRefresh() { await fetchData(); renderCards(); }
        function renderCards() {
            const grid = document.getElementById('admin-grid'); grid.innerHTML = '';
            const search = document.getElementById('admSearch').value.toLowerCase(); const filter = document.getElementById('admFilter').value.toLowerCase();
            
            if(!globalData.users) { globalData.users = []; }

            globalData.users.forEach((u, idx) => {
                const emailDB = (u.email || "").toLowerCase();
                const statusDB = (u.status || "").toString().toLowerCase();

                if (emailDB.includes(search) && (filter === "all" || statusDB === filter)) {
                    const isClaimed = u.claim_status === "Claimed";
                    let statusClass = 'bg-gray';
                    if(statusDB.includes('new')) statusClass = 'bg-green';
                    if(statusDB.includes('restric')) statusClass = 'bg-red';

                    const card = document.createElement('div'); card.className = 'user-card';
                    card.innerHTML = `
                        <div class="uc-header">${u.email}</div>
                        <div class="uc-badges">
                            <span class="badge ${statusClass}">${u.status}</span>
                            <span class="badge ${isClaimed?'bg-red':'bg-green'}">${isClaimed?'Sudah Diambil':'Belum Claim'}</span>
                        </div>
                        <div class="uc-action-area">
                            <div class="input-row">
                                <label>Reward:</label>
                                <input type="number" id="rew-${idx}" value="${u.reward}" style="padding:6px;">
                                <button class="btn-icon" style="background:var(--accent);" onclick="saveReward(${idx})" title="Simpan">${ICONS.save}</button>
                            </div>
                            <div class="btn-grid">
                                <button class="btn-icon" style="background:${isClaimed?'#ef4444':'#10b981'};" onclick="toggleClaim(${idx})">
                                    ${isClaimed?ICONS.x+' Batal':ICONS.check+' Bayar'}
                                </button>
                                <button class="btn-icon" style="background:#f59e0b; color:black;" onclick="resetUser(${idx})">
                                    ${ICONS.rotate} Reset
                                </button>
                            </div>
                        </div>`;
                    grid.appendChild(card);
                }
            });
        }
        function openMassModal() { document.getElementById('massModal').style.display = 'flex'; }
        function closeMassModal() { document.getElementById('massModal').style.display = 'none'; }
        function confirmMassUpdate() {
            const statusTarget = document.getElementById('massStatusSelect').value; const newAmount = document.getElementById('massAmount').value;
            if (!newAmount) { alert("Mohon isi nominal reward."); return; }
            if(confirm(`Ubah semua user '${statusTarget}' jadi Rp ${newAmount}?`)) {
                let count = 0; globalData.users.forEach(u => { if ((u.status || "").trim().toLowerCase() === statusTarget.toLowerCase()) { u.reward = newAmount; count++; } });
                if (count > 0) { saveData(globalData); closeMassModal(); } else { alert("Tidak ada user dengan status tersebut."); }
            }
        }
        function openResetChoiceModal() { document.getElementById('resetChoiceModal').style.display = 'flex'; }
        function closeResetChoiceModal() { document.getElementById('resetChoiceModal').style.display = 'none'; }
        function executeReset(type) {
            if (prompt("KETIK 'RESET' UNTUK MENGKONFIRMASI:") !== 'RESET') { alert("Batal."); return; }
            if (type === 'claim') { globalData.users.forEach(u => u.claim_status = ""); alert("Status Claim di-reset."); } else if (type === 'reward') { globalData.users.forEach(u => u.reward = "0"); alert("Nominal Reward di-reset."); }
            saveData(globalData); closeResetChoiceModal();
        }
        function saveReward(idx) { 
            const inputEl = document.getElementById(`rew-${idx}`);
            if(inputEl) { globalData.users[idx].reward = inputEl.value; saveData(globalData); }
        }
        function toggleClaim(idx) { const curr = globalData.users[idx].claim_status; globalData.users[idx].claim_status = curr === "Claimed" ? "" : "Claimed"; saveData(globalData); }
        function resetUser(idx) { if(confirm("Hapus data user ini?")) { globalData.users[idx].claim_status = ""; globalData.users[idx].reward = "0"; saveData(globalData); } }

        // --- SOUND EFFECT (Web Audio API) ---
        function playClickSound() {
            const context = new (window.AudioContext || window.webkitAudioContext)();
            const osc = context.createOscillator();
            const gainNode = context.createGain();
            
            // Pop sound config
            osc.type = 'sine';
            osc.frequency.setValueAtTime(800, context.currentTime);
            osc.frequency.exponentialRampToValueAtTime(100, context.currentTime + 0.05);
            
            gainNode.gain.setValueAtTime(0.1, context.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.001, context.currentTime + 0.05);
            
            osc.connect(gainNode);
            gainNode.connect(context.destination);
            
            osc.start();
            osc.stop(context.currentTime + 0.05);
        }

        // Global Event Listener for Clicks
        document.addEventListener('click', function(e) {
            if(e.target.closest('button') || e.target.closest('.bank-item') || e.target.closest('input[type="checkbox"]') || e.target.closest('.admin-trigger')) {
                playClickSound();
            }
        });
    </script>
</body>
</html>
